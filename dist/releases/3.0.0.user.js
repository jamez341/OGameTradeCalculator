// ==UserScript==
// @name         OGame Trade Calculator
// @description  Adds a trade calculator to the OGame interface
// @namespace    https://github.com/EliasGrande/
// @downloadURL  https://github.com/EliasGrande/OGameTradeCalculator/raw/master/dist/releases/latest.user.js
// @updateURL    https://github.com/EliasGrande/OGameTradeCalculator/raw/master/dist/releases/latest.meta.js
// @version      3.0.0
// @include      *://*.ogame.*/game/index.php?*page=*
// ==/UserScript==
/*! OGame Trade Calculator (C) 2014 Elías Grande Cásedas | MIT | opensource.org/licenses/MIT */
(function(){var i=window,q,f;try{if(unsafeWindow){i=unsafeWindow}}catch(j){}q=i.document;f=i.jQuery;var l,k,g,o;k={VERSION:[3,0,0],ID_PREFIX:(l="o_trade_calc_"),NAME:"OGame Trade Calculator",HOME_URL:"https://github.com/EliasGrande/OGameTradeCalculator/",TESTED_OGAME_VERSION:"5.7.9"};g=function(e){var t,s=e.split(/\D+/g);for(t in s){s[t]=parseInt(s[t])}return s};o=function(x,w,s){var u,t=x.length,e=w.length,v=Math.min(t,e);for(u=0;u<v;u++){if(x[u]>w[u]){return false}else{if(x[u]<w[u]){return true}}}if(t>e){return false}if(t<e){return true}if(arguments.length>2&&s){return true}return false};var h={obj:i.localStorage,set:function(s,e){return this.obj.setItem(l+s,JSON.stringify(e))},get:function(s){var e=this.obj.getItem(l+s);return(e==null)?null:JSON.parse(e)},remove:function(e){return this.obj.removeItem(l+e)}};String.prototype.replaceAll=function(e,s){return this.split(e).join(s)};String.prototype.recursiveReplaceMap=function(v,u,s){if(s==0){return this.split(v[0]).join(u[0])}var t,e=this.split(v[s]);for(t in e){e[t]=e[t].recursiveReplaceMap(v,u,s-1)}return e.join(u[s])};String.prototype.replaceMap=function(e){var s,v,u,t;v=new Array();u=new Array();t=0;for(s in e){v.push(s);u.push(e[s]);t++}if(t==0){return this}else{return this.recursiveReplaceMap(v,u,t-1)}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};String.prototype.parseUnicodeEscapes=function(){var e=/\\u\w{4}/.exec(this);if(e==null){return this+""}else{return this.replace(e,String.fromCharCode(parseInt((e+"").substring(2),16))).parseUnicodeEscapes()}};var a=function(){f.getScript("/cdn/js/greasemonkey/version-check.js",function(){i.oGameVersionCheck(k.NAME,k.TESTED_OGAME_VERSION,k.HOME_URL)});
/*! jCaret (C) 2010 C. F. Wong | cloudgen.w0ng.hk | www.opensource.org/licenses/mit-license.php */
(function(T,R,S,U){T.fn.caret=function(aj,af){var W,Z,ah=this[0],ab=/MSIE/.test(i.navigator.userAgent);if(typeof aj==="object"&&typeof aj.start==="number"&&typeof aj.end==="number"){W=aj.start;Z=aj.end}else{if(typeof aj==="number"&&typeof af==="number"){W=aj;Z=af}else{if(typeof aj==="string"){if((W=ah.value.indexOf(aj))>-1){Z=W+aj[R]}else{W=null}}else{if(Object.prototype.toString.call(aj)==="[object RegExp]"){var ag=aj.exec(ah.value);if(ag!=null){W=ag.index;Z=W+ag[0][R]}}}}}if(typeof W!="undefined"){if(ab){var ac=this[0].createTextRange();ac.collapse(true);ac.moveStart("character",W);ac.moveEnd("character",Z-W);ac.select()}else{this[0].selectionStart=W;this[0].selectionEnd=Z}this[0].focus();return this}else{if(ab){var ae=document.selection;if(this[0].tagName.toLowerCase()!="textarea"){var X=this.val(),aa=ae[S]()[U]();aa.moveEnd("character",X[R]);var ai=(aa.text==""?X[R]:X.lastIndexOf(aa.text));aa=ae[S]()[U]();aa.moveStart("character",-X[R]);var ad=aa.text[R]}else{var aa=ae[S](),V=aa[U]();V.moveToElementText(this[0]);V.setEndPoint("EndToEnd",aa);var ai=V.text[R]-aa.text[R],ad=ai+aa.text[R]}}else{var ai=ah.selectionStart,ad=ah.selectionEnd}var Y=ah.value.substring(ai,ad);return{start:ai,end:ad,text:Y,replace:function(ak){return ah.value.substring(0,ai)+ak+ah.value.substring(ad,ah.value[R])}}}}})(f,"length","createRange","duplicate");
/*! [/jCaret] */
;var e=({getMeta:function(R,S){try{return f('meta[name="'+R+'"]').attr("content")}catch(T){if(arguments.length>1){return S}else{return null}}},init:function(){return{LANGUAGE:this.getMeta("ogame-language",""),VERSION:g(this.getMeta("ogame-version","0"))}}}).init();
/*! [colors] */
;var C={MET:"#FF7700",CRY:"#00FFFF",DEU:"#FF33FF",SC:"#FFFFFF",LC:"#FFFFFF"};
/*! [/colors] */
;var D=({text:{},set:function(R,S){if(R.test(e.LANGUAGE)){f.extend(true,this.text,S)}return this},init:function(){var S,R,U=/[\|\:]/;try{R=(i.initAjaxResourcebox+"");R=R.split(/tooltip\s*[\"\']?\s*\:\s*[\"\']/);for(S=0;S<3;S++){R[S]=R[S+1].split(U).shift().trim().parseUnicodeEscapes();if(R[S]==""){throw 0}}}catch(T){R=["Metal","Crystal","Deuterium"]}this.text.RES_MET=R[0];this.text.RES_CRY=R[1];this.text.RES_DEU=R[2];return this}}).init();
/*! [i18n=en] */
;D.set(/.*/,{THO_SEP:",",DEC_SEP:".",MENU:"Trade C.",TITLE:"Trade calculator",CONFIG:"Settings",ACTION:"Action",BUY:"I buy",SELL:"I sell",RATIO:"Ratio",ILLEGAL:"illegal",MAX:"Maximum",REG:"Regular",MIN:"Minimum",IN_EXCH:"In exchange for",RESULT:"Result",SEND:"I send",RECEIVE:"I receive",RES:"Resources",LC_SHIP:"LC",SC_SHIP:"SC",OR:"or",MESSAGE:"Message",WHERE:"Place of delivery",PLANET:"Planet",MOON:"Moon",CUR_PLA:"Current planet",SEL_CUR:"Select current planet or moon",RAT_LST:"Ratio list",NAME:"Name",LEGAL:"Legal",YES:"Yes",NO:"No",DEFAULT:"Default",NEW:"New",DEF_VAL:"Default values",ABB_KEY:"Abbreviations and auto-complete keys",USE_ABB:"Use abbreviations when possible",UNABB:"Unabbreviate fields when the mouse is over them",ABB_MIL:"Abbreviation for millions",ABB_THO:"Abbreviation for thousands",KEY_MIL:"Key to write millions (6 zeros)",KEY_THO:"Key to write thousands (3 zeros)",MES_TPL:"Message template",RES_DTP:"Restore default template",IE_CONF:"Import / Export configuration",IMPORT:"Import",EXPORT:"Export",ACCEPT:"Accept",CANCEL:"Cancel",RES_DEF:"Restore default settings",CONTACT:"Contact information"});
/*! [i18n=es] */
;D.set(/es|ar|mx/,{THO_SEP:".",DEC_SEP:",",MENU:"C. Comercio",TITLE:"Calculadora de comercio",CONFIG:"Configuración",ACTION:"Acción",BUY:"Compro",SELL:"Vendo",RATIO:"Ratio",ILLEGAL:"ilegal",MAX:"Máximo",REG:"Normal",MIN:"Mínimo",IN_EXCH:"A cambio de",RESULT:"Resultado",SEND:"Envío",RECEIVE:"Recibo",RES:"Recursos",LC_SHIP:"NGC",SC_SHIP:"NPC",OR:"o",MESSAGE:"Mensaje",WHERE:"Lugar de entrega",PLANET:"Planeta",MOON:"Luna",CUR_PLA:"Planeta actual",SEL_CUR:"Seleccionar planeta o luna actual",RAT_LST:"Lista de ratios",NAME:"Nombre",LEGAL:"Legal",YES:"Si",NO:"No",DEFAULT:"Por defecto",NEW:"Nuevo",DEF_VAL:"Valores por defecto",ABB_KEY:"Abreviaciones y teclas de autocompletado",USE_ABB:"Usar abreviaciones cuando sea posible",UNABB:"Desabreviar campos al poner el ratón encima",ABB_MIL:"Abreviación para millones",ABB_THO:"Abreviación para miles",KEY_MIL:"Tecla para escribir millones (6 ceros)",KEY_THO:"Tecla para escribir miles (3 ceros)",MES_TPL:"Plantilla de mensaje",RES_DTP:"Restaurar plantilla por defecto",IE_CONF:"Importar / Exportar configuración",IMPORT:"Importar",EXPORT:"Exportar",ACCEPT:"Aceptar",CANCEL:"Cancelar",RES_DEF:"Restaurar ajustes por defecto",CONTACT:"Información de contacto"});
/*! [i18n=nl] by sanctuary http://userscripts-mirror.org/users/431052 */
;D.set(/nl/,{THO_SEP:",",DEC_SEP:".",MENU:"Trade C.",TITLE:"Trade calculator",CONFIG:"Instellingen",ACTION:"Actie",BUY:"Ik koop",SELL:"Ik verkoop",RATIO:"Verhouding",ILLEGAL:"illegaal",MAX:"Maximaal",REG:"Gemiddeld",MIN:"Minimaal",IN_EXCH:"In ruil voor",RESULT:"Resultaat",SEND:"Ik verstuur",RECEIVE:"Ik ontvang",RES:"Grondstoffen",LC_SHIP:"GV",SC_SHIP:"KV",OR:"of",MESSAGE:"Bericht",WHERE:"Plaats van levering",PLANET:"Planeet",MOON:"Maan",CUR_PLA:"Huidige planeet",SEL_CUR:"Kies huidige planeet of maan",RAT_LST:"Verhouding lijst",NAME:"Naam",LEGAL:"Legaal",YES:"Ja",NO:"Nee",DEFAULT:"Standaard",NEW:"Nieuw",DEF_VAL:"Standaard waarde",ABB_KEY:"Toets afkortingen en automatisch aanvullen",USE_ABB:"Gebruik afkortingen wanneer mogelijk",UNABB:"Verkort velden wanneer de muis over het veld staat",ABB_MIL:"Afkorting voor miljoen",ABB_THO:"Afkorting voor duizend",KEY_MIL:"Toets voor miljoen te schrijven (6 nullen)",KEY_THO:"Toets voor duizend te schrijven (3 nullen)",MES_TPL:"Bericht sjabloon",RES_DTP:"Herstel standaard sjabloon",IE_CONF:"Invoer / Uitvoer configuratie",IMPORT:"Invoer",EXPORT:"Uitvoer",ACCEPT:"Accepteer",CANCEL:"Annuleer",RES_DEF:"Herstel naar standaard instellingen",CONTACT:"Contactinformatie"});
/*! [i18n=it] by adyr http://userscripts-mirror.org/topics/122435 */
;D.set(/it/,{THO_SEP:",",DEC_SEP:".",MENU:"Commercio C.",TITLE:"Commercio calcolatrice",CONFIG:"Opzioni",ACTION:"Azione",BUY:"Compro",SELL:"Vendo",RATIO:"Rapporto",ILLEGAL:"illegale",MAX:"Massimo",REG:"Regolare",MIN:"Minimo",IN_EXCH:"In cambio di",RESULT:"Risultato",SEND:"Mando",RECEIVE:"Ricevo",RES:"Risorse",LC_SHIP:"CP",SC_SHIP:"CL",OR:"o",MESSAGE:"Messaggio",WHERE:"Ricevo su",PLANET:"Pianeta",MOON:"Luna",CUR_PLA:"Pianeta corrente",SEL_CUR:"Selezionare pianeta corrente",RAT_LST:"Rapporti",NAME:"Nome",LEGAL:"Legale",YES:"Si",NO:"No",DEFAULT:"Default",NEW:"Nuovo",DEF_VAL:"Valori di default",ABB_KEY:"Abbreviazioni e pulsanti di auto-completamento",USE_ABB:"Usa abbreviazioni quando possibile",UNABB:"Annulla abbreviazioni se il campo è sotto al mouse",ABB_MIL:"Abbreviazione per milioni",ABB_THO:"Abbreviazione per migliaia",KEY_MIL:"Tasto per scrivere milioni (6 zero)",KEY_THO:"Tasto per scrivere migliaia (3 zero)",MES_TPL:"Template del messaggio",RES_DTP:"Ripristina il template di default",IE_CONF:"Importa / Esporta configurazione",IMPORT:"Importa",EXPORT:"Esporta",ACCEPT:"Accetta",CANCEL:"Cancella",RES_DEF:"Ripristina impostazioni di default",CONTACT:"Informazioni di contatto"});
/*! [i18n=fr] by vulca http://userscripts-mirror.org/users/100684 */
;D.set(/fr/,{THO_SEP:" ",DEC_SEP:",",MENU:"C. Échange",TITLE:"Calculateur d'échange",CONFIG:"Options",ACTION:"Action",BUY:"J'achète",SELL:"Je vends",RATIO:"Ratio",ILLEGAL:"illegal",MAX:"Maximum",REG:"Habituel",MIN:"Minimum",IN_EXCH:"En échange de",RESULT:"Résultat",SEND:"J'envoie",RECEIVE:"Je reçois",RES:"Ressources",LC_SHIP:"GT",SC_SHIP:"PT",OR:"ou",MESSAGE:"Message",WHERE:"Lieu de livraison",PLANET:"Planète",MOON:"Lune",CUR_PLA:"Planète actuelle",SEL_CUR:"Sélectionner la planète ou lune actuelle",RAT_LST:"Liste des ratios",NAME:"Nom",LEGAL:"Legal",YES:"Oui",NO:"Non",DEFAULT:"Defaut",NEW:"Nouveau",DEF_VAL:"Valeurs par défaut",ABB_KEY:"Abbréviations et raccourcis",USE_ABB:"Utiliser les abbréviations quand c'est possible",UNABB:"Ne pas afficher d'abbréviation lorsque la souris est au dessus du champ",ABB_MIL:"Abbreviation pour millions",ABB_THO:"Abbreviation pour thousands",KEY_MIL:"Raccourcis pour écrire millions (6 zéros)",KEY_THO:"Raccourcis pour écrire milliers (3 zéros)",MES_TPL:"Format du message",RES_DTP:"Restorer le format par defaut",IE_CONF:"Configuration des Imports / Exports",IMPORT:"Import",EXPORT:"Export",ACCEPT:"Accepter",CANCEL:"Annuler",RES_DEF:"Restorer les options par defaut",CONTACT:"Contact"});
/*! [/i18n] */
;D=D.text;var w={init:function(){for(var S in this){if(typeof(this[S])=="string"){for(var R in this){if(typeof(this[R])=="string"){this[S]=this[S].replaceAll("{this."+R+"}",this[R])}}}}}};
/*! [css] */
;w.CSS="#"+l+"window select{visibility:visible !important;}#"+l+"window{float:left;position:relative;width:670px;overflow:visible;z-index:2;}#galaxy #"+l+"window{top:-44px;}#"+l+'header{height:28px;position: relative;background: url("http://gf1.geo.gfsrv.net/cdn63/10e31cd5234445e4084558ea3506ea.gif") no-repeat scroll 0px 0px transparent;}#'+l+"header h4{height:28px;line-height:28px;text-align:center;color:#6F9FC8;font-size:12px;font-weight:bold;position:absolute;top:0;left:100px;right:100px;}#"+l+"config_but{display:block;height:16px;width:16px;background:url(http://gf3.geo.gfsrv.net/cdne7/1f57d944fff38ee51d49c027f574ef.gif);float:right;margin:8px 0 0 0;opacity:0.5;}#"+l+"config_but:hover{opacity:1;}#"+l+'window.config input[type="button"]{margin:0 5px 0 5px;}#'+l+"config,#"+l+"window.config #"+l+"calc,#"+l+"window.config #"+l+"config_but,#"+l+"window.calc ."+l+"config_only{display:none;}#"+l+"window.config #"+l+"config{display:block;}#"+l+'main{padding:15px 25px 0 25px;background: url("http://gf1.geo.gfsrv.net/cdn9e/4f73643e86a952be4aed7fdd61805a.gif") repeat-y scroll 5px 0px transparent;}#'+l+"main *{font-size:11px;}#"+l+"window table{width:620px;background-color:#0D1014;border-collapse:collapse;clear:both;}#"+l+"window.calc table{border:1px solid #000;margin:0 0 20px 0;}#"+l+"window.calc table.last{margin:0;}#"+l+"window.config table{width:598px;}#"+l+"main th{color:#6F9FC8;text-align:center;font-weight:bold;}."+l+"label,."+l+"label *{color:grey;text-align:left;}."+l+"label{padding:0 5px 0 5px;font-weight:bold;}#"+l+"window.config ."+l+"label{text-align:center;}#"+l+"main tr,#"+l+"main td,#"+l+"main th{height:28px;line-height:28px;}#"+l+'main input[type="text"]{width:100px;text-align:center;}option.'+l+"highlight{color:lime !important;font-weight:bold;}option."+l+"moon{color:orange;}."+l+"select{width:150px;text-align:left;}."+l+"select select{width:130px;text-align:center;}#"+l+"main option{padding:1px 5px 1px 5px;}."+l+"input,."+l+"output{width:112px;padding:0 2px 0 0;}."+l+"name{width:142px;padding:0 1px 0 1px;text-align:right;}#"+l+"main ."+l+"name input{width:130px;text-align:center;}."+l+"ratio{width:82px;padding:0 1px 0 1px;text-align:right;}#"+l+"main ."+l+"ratio input{width:70px;text-align:center;}#"+l+"ratio_illegal{color:red;}."+l+"output{text-align:center;font-weight:bold;}#"+l+"output_met{color:"+C.MET+";}#"+l+"output_cry{color:"+C.CRY+";}#"+l+"output_deu{color:"+C.DEU+";}."+l+"textarea{padding:0 3px 0 3px !important;}#"+l+"message{width:601px;height:50px !important;margin:0 !important;}#"+l+"planet{width:auto;text-align:left;margin:0;}."+l+"select1row{padding-left:2px;}."+l+"select1row select{width:250px !important;text-align:left;margin:0;}#"+l+"selCurPla_button{margin-left:30px}#"+l+'footer{height:17px;background: url("http://gf1.geo.gfsrv.net/cdn30/aa3e8edec0a2681915b3c9c6795e6f.gif") no-repeat scroll 2px 0px transparent;}.'+l+'config_title{font-size:11px;font-weight:bold;color:#6F9FC8;line-height:22px;background:url("http://gf1.geo.gfsrv.net/cdn0b/d55059f8c9bab5ebf9e8a3563f26d1.gif") no-repeat scroll 0 0 #13181D;height:22px;margin:0 0 10px 0;padding:0 0 0 40px;border:1px solid #000;overflow:hidden;cursor:pointer;}.'+l+"config_title:hover{color:#A7AFB7;background-color:#23282D;border-color:#13181D;}."+l+"config_box{border:1px solid #000;margin:5px 5px 10px 5px;padding:5px;}#"+l+"new_ratio input{border-color:#9C0;}."+l+"check,."+l+"name_noedit{text-align:center;}."+l+"check input{vertical-align:text-bottom;}."+l+'check input[type="checkbox"]{vertical-align:middle;}.'+l+"action{text-align:center;padding:0 3px 0 3px;}."+l+'action a{background:url("http://gf1.geo.gfsrv.net/cdn94/297ee218d94064df0a66bd41a04d28.png") scroll 0 0 no-repeat;width:16px;height:16px;display:inline-block;vertical-align:top;position:relative;top:5px;border:1px solid #000;border-radius:2px;opacity:0.7;}a.'+l+"icon_up,a."+l+"icon_down,a."+l+"icon_add{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAwCAMAAAAvgQplAAAAAXNSR0IArs4c6QAAAvpQTFRFbomeXHaLb4mdgpyveJaxdpSweZKk////W3qXVnKNRWB6AAAANTU1PT09MUJTJzVD/6gAzAAA/9IA/wAAqsrjvtjrna25PlVsTWiCqbjESGF6YHyaOk9ldZOwTWeCPj4+PlRsVHeYRGKBUXCRQVx6VnibTGmFVnmbRWOERWSEXn+chJusPVhzU3SVQ19+TGyKU3aXPVRrTGqHkrHKPVZwUW6KQ2GAU3aZO09lcJCqYHqORV95UW6LTGeBQFlySGB5SmF6Q2B+VnmaUG2JVnSQS2qHSmeCL0RaXHmUU3WVoLzSqcTYQ2GCPFZxPVZxkaa1RWSDPFZyRl96XH2ZTGqGS2qJO1Ru1d7lV3SROk5kQVp0QVpz5erua4OWqLnGpcDUWn2ewMzVlK/EqLbCcY+qj6zESmF3r7zHob3TTGaAlqi2haO9XniNQ115TWiD8vX4k7DGZ4mqyNTdSmaBpcHWcImdjaKynbrRdY6hvMnTSWeHYXyaq7jDV3SQ6+/zo7/Ur8rd8PP1javGhaK82uLmq8bZq7vHh6a+0NrgnLjOhJqqUG+QpL/VsL7JdJOuXnmSytTcj6OxT2qE+Pn7eZm0zCszfZmxhqXBdZGpXHaOS2uKboynr73J4ebrhKO7obLAmLfR+vv9nLfNip+uX3yYXn+bdoyec42gobC9pbS/yNPbYX2aPVRtt8XPmLTLbo2odI2geI2fVHKT2OHo3OLoRGGBRmODkK7HaImkaomka4unjaCw/f7/mbjRXnyXd4+jf5Wmp8HWjq3IiqnEeZOqPlVtVHeXYH2ai6CxYYCbZIKfZn+TTGeDVnWQb5GtVnWRSWWASmWATGuKc5CpusXOU3GQlLPMXHqXUnSUZoSifJq0fJu3ZHyT/v//dpOwqcXZYHqSYnuQ7fDz7PD0XHyYWnaRkKW1TGiFTGmEj6zDYXuPPFdzPVdzrsndhpytVHaYh52uXn6c8PP2jqzFQFt5jKvFcYqeQl99gZ+52uHmRGKAyNTcV3iaqsbZDVW+rgAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3AsJFTcNV6u1fQAAAE9JREFUKM/dkjEOACAIA6tL//9jFaORqhtxsBO9CS4AyQXSKwkEpAfkIMgttNh4AUtCALQ/9NGPu4A87/erj/6DD30HBZuPwztsPmIFqY8CjdEFo21taJsAAAAASUVORK5CYII=);}a."+l+"icon_down{background-position:0px -16px}a."+l+"icon_add{background-position:0px -32px}."+l+"action a:hover{opacity:1;border-color:#08090b;}."+l+"action a.disabled,."+l+"action aldisabled:hover{opacity:0.1;cursor:default;}a."+l+"icon_trash{background-position:0px -304px}#"+l+"window.config .undermark,#"+l+"window.config .overmark{font-weight:bold;text-align:center;}#"+l+"window.config textarea{display:block;width:586px;margin:0 0 5px 0;}."+l+"ie_conf{text-align:center}."+l+"hidden{position:fixed;left:-10000px;}."+l+"fieldwrapper:before,."+l+'fieldwrapper:after{content:"";display:table;}.'+l+"fieldwrapper:after{clear:both;}."+l+"fieldwrapper{padding:7px 0 7px 0;}."+l+"fieldwrapper label,."+l+"thefield{color:#6F9FC8;height:22px;line-height:22px;float:left;margin:2px 0 0 0;}."+l+"fieldwrapper label{font-weight:bold;width:320px;margin:0 15px 0 0;padding:0 0 0 10px;}."+l+'thefield input[type="text"],.'+l+"thefield select{width:200px}";
/*! [tpl=action_options] */
;w.ACTION_OPT='<option value="sell">'+D.SELL+'</option><option value="buy">'+D.BUY+"</option>";
/*! [tpl=output_options] */
;w.OUTPUT_OPT='<option value="m">'+D.RES_MET+'</option><option value="c">'+D.RES_CRY+'</option><option value="d">'+D.RES_DEU+'</option><option value="mc">'+D.RES_MET+" + "+D.RES_CRY+'</option><option value="md">'+D.RES_MET+" + "+D.RES_DEU+'</option><option value="cd">'+D.RES_CRY+" + "+D.RES_DEU+"</option>";
/*! [tpl=void_href] */
;w.VOID_HREF='href="javascript:void(0)"';
/*! [tpl=window] */
;w.WINDOW='<div id="'+l+'window" class="calc"><div id="'+l+'header"><h4>'+D.TITLE+'<span class="'+l+'config_only"> &raquo; '+D.CONFIG+'</span></h4><a id="'+l+'close" href="javascript:void(0);" class="close_details close_ressources"></a><a id="'+l+'config_but" href="javascript:void(0);"></a></div><div id="'+l+'main"><div id="'+l+'calc"><table cellspacing="0" cellpadding="0"><tbody><tr><th colspan="2"></th><th>'+D.RES_MET+"</th><th>"+D.RES_CRY+"</th><th>"+D.RES_DEU+'</th></tr><tr class="alt"><td class="'+l+'label">'+D.ACTION+'</td><td class="'+l+'select"><select id="'+l+'action">{this.ACTION_OPT}</select></td><td class="'+l+'input"><input id="'+l+'input_met" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'input_cry" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'input_deu" type="text" value=""></td></tr><tr><td class="'+l+'label">'+D.RATIO+'<span id="'+l+'ratio_illegal"> ('+D.ILLEGAL+')</span></td><td class="'+l+'select"><select id="'+l+'ratio"></select></td><td class="'+l+'input"><input id="'+l+'ratio_met" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'ratio_cry" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'ratio_deu" type="text" value=""></td></tr><tr class="alt"><td class="'+l+'label">'+D.IN_EXCH+'</td><td class="'+l+'select"><select id="'+l+'output">{this.OUTPUT_OPT}</select></td><td class="'+l+'input"><input id="'+l+'percent_met" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'percent_cry" type="text" value=""></td><td class="'+l+'input"><input id="'+l+'percent_deu" type="text" value=""></td></tr><tr><td class="'+l+'label" colspan="2">'+D.RESULT+'</td><td class="'+l+'output" id="'+l+'output_met"></td><td class="'+l+'output" id="'+l+'output_cry"></td><td class="'+l+'output" id="'+l+'output_deu"></td></tr></tbody></table><table cellspacing="0" cellpadding="0"><tbody><tr><th></th><th>'+D.RES+"</th><th>"+D.LC_SHIP+"</th><th>"+D.SC_SHIP+'</th></tr><tr class="alt"><td class="'+l+'label">'+D.SEND+'</td><td class="'+l+'output overmark" id="'+l+'sendRes">0</td><td class="'+l+'output" id="'+l+'sendLC">0</td><td class="'+l+'output" id="'+l+'sendSC">0</td></tr><tr><td class="'+l+'label">'+D.RECEIVE+'</td><td class="'+l+'output undermark" id="'+l+'receiveRes">0</td><td class="'+l+'output" id="'+l+'receiveLC">0</td><td class="'+l+'output" id="'+l+'receiveSC">0</td></tr></tbody></table><table cellspacing="0" cellpadding="0"><tbody><tr class="alt"><td class="'+l+'label" colspan="5">'+D.WHERE+'</td></tr><tr class="alt"><td class="'+l+'select1row" colspan="5"><select id="'+l+'planet"></select><a {this.VOID_HREF} id="'+l+'selCurPla_button">'+D.SEL_CUR+'</a></td></tr></tbody></table><table cellspacing="0" cellpadding="0" class="last"><tbody><tr class="alt"><td class="'+l+'label" colspan="5">'+D.MESSAGE+'</td></tr><tr class="alt"><td class="'+l+'textarea" colspan="5"><textarea id="'+l+'message" cols="1" rows="1" readonly="readonly"></textarea></td></tr></tbody></table></div><div id="'+l+'config"><div class="'+l+'config_title">'+D.RAT_LST+'</div><div class="'+l+'config_box"><table cellspacing="0" cellpadding="0"><tbody id="'+l+'ratioList"><tr><th>#</th><th>'+D.NAME+"</th><th>"+D.RES_MET+"</th><th>"+D.RES_CRY+"</th><th>"+D.RES_DEU+"</th><th>"+D.ACTION+"</th><th>"+D.LEGAL+"</th><th>"+D.DEFAULT+'</th></tr></tbody></table></div><div class="'+l+'config_title">'+D.DEF_VAL+'</div><div class="'+l+"config_box "+l+'hidden"><div class="'+l+'fieldwrapper"><label>'+D.ACTION+':</label><div class="'+l+'thefield"><select id="'+l+'defAction">{this.ACTION_OPT}</select></div></div><div class="'+l+'fieldwrapper"><label>'+D.IN_EXCH+':</label><div class="'+l+'thefield"><select id="'+l+'defOutput">{this.OUTPUT_OPT}</select></div></div><div class="'+l+'fieldwrapper"><label>'+D.SEL_CUR+':</label><div class="'+l+'thefield"><input id="'+l+'selCurPla" type="checkbox" /></div></div></div><div class="'+l+'config_title">'+D.ABB_KEY+'</div><div class="'+l+"config_box "+l+'hidden"><div class="'+l+'fieldwrapper"><label>'+D.USE_ABB+':</label><div class="'+l+'thefield"><input id="'+l+'abb" type="checkbox" /></div></div><div class="'+l+'fieldwrapper"><label>'+D.UNABB+':</label><div class="'+l+'thefield"><input id="'+l+'overUnabb" type="checkbox" /></div></div><div class="'+l+'fieldwrapper"><label>'+D.ABB_MIL+':</label><div class="'+l+'thefield"><input id="'+l+'millionAbb" type="text" maxlength="10" /></div></div><div class="'+l+'fieldwrapper"><label>'+D.ABB_THO+':</label><div class="'+l+'thefield"><input id="'+l+'thousandAbb" type="text" maxlength="10" /></div></div><div class="'+l+'fieldwrapper"><label>'+D.KEY_MIL+':</label><div class="'+l+'thefield"><input id="'+l+'millionKey" type="text" maxlength="1" /></div></div><div class="'+l+'fieldwrapper"><label>'+D.KEY_THO+':</label><div class="'+l+'thefield"><input id="'+l+'thousandKey" type="text" maxlength="1" /></div></div></div><div class="'+l+'config_title">'+D.MES_TPL+'</div><div class="'+l+"config_box "+l+'hidden"><textarea id="'+l+'messageTpl"></textarea><div class="textCenter"><input id="'+l+'messageTpl_restore" type="button" value="'+D.RES_DTP+'" class="btn_blue"></div></div><div class="'+l+'config_title">'+D.IE_CONF+'</div><div class="'+l+"config_box "+l+"ie_conf "+l+'hidden"><textarea id="'+l+'ie_conf"></textarea><input id="'+l+'ie_import" type="button" value="'+D.IMPORT+'" class="btn_blue"><input id="'+l+'ie_export" type="button" value="'+D.EXPORT+'" class="btn_blue"></div><div class="'+l+'config_title">'+D.CONTACT+'</div><div class="'+l+"config_box "+l+'hidden"><table cellspacing="0" cellpadding="0"><tbody><tr class="alt"><td class="'+l+"label "+l+'pos">1</td><td>GitHub</td><td><a href="https://github.com/EliasGrande/OGameTradeCalculator/issues" target="_blank">Issues · EliasGrande/OGameTradeCalculator - github.com</a></td></tr><tr><td class="'+l+"label "+l+'pos">2</td><td>Ogame Origin</td><td><a href="http://board.origin.ogame.de/board6-origin/board38-tools-scripts-skins/board39-tolerated-tools-addons-scripts/4367-ogame-trade-calculator/" target="_blank">[Tolerated] OGame Trade Calculator - board.origin.ogame.de</a></td></tr><tr class="alt"><td class="'+l+"label "+l+'pos">3</td><td>Ogame España</td><td><a href="http://board.ogame.com.es/board859-ogamelacomunidad/board860-comunidad/board422-utilidadesyskinsparaogame/1224751-scriptcalculadoradecomerciolegal/" target="_blank">[Script] Calculadora de Comercio [Legal] - board.ogame.com.es</a></td></tr></tbody></table></div><div class="textCenter"><input id="'+l+'config_accept" type="button" value="'+D.ACCEPT+'" class="btn_blue"><input id="'+l+'config_cancel" type="button" value="'+D.CANCEL+'" class="btn_blue"><input id="'+l+'config_default" type="button" value="'+D.RES_DEF+'" class="btn_blue"></div></div></div><div id="'+l+'footer"></div></div>';
/*! [tpl=button] */
;w.MENUBUTTON='<li><a id="'+l+'menubutton" class="menubutton" href="javascript:void(0)" accesskey="" target="_self"><span class="textlabel">'+D.MENU+"</span></a></li>";
/*! [tpl=ratio_list_limit] */
;w.RATIO_LIST_LIMIT='<tr><td class="'+l+"label "+l+'pos"></td><td class="'+l+'name_noedit"></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_met" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_cry" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_deu" type="text" /></td><td class="'+l+'action"><a {this.VOID_HREF} class="'+l+'icon_up"></a><a {this.VOID_HREF} class="'+l+'icon_down"></a><a {this.VOID_HREF} class="'+l+'icon_trash disabled"></a></td><td class="'+l+'label">-</td><td class="'+l+'check"><input name="'+l+'def_ratio" type="radio" /></td></tr>';
/*! [tpl=ratio_list_item] */
;w.RATIO_LIST_ITEM='<tr><td class="'+l+"label "+l+'pos"></td><td class="'+l+'name"><input class="'+l+'edit_ratio_name" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_met" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_cry" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_deu" type="text" /></td><td class="'+l+'action"><a {this.VOID_HREF} class="'+l+'icon_up"></a><a {this.VOID_HREF} class="'+l+'icon_down"></a><a {this.VOID_HREF} class="'+l+'icon_trash"></a></td><td class="'+l+'legal"></td><td class="'+l+'check"><input name="'+l+'def_ratio" type="radio" /></td></tr>';
/*! [tpl=ratio_list_new] */
;w.RATIO_LIST_NEW='<tr id="'+l+'new_ratio"><td class="undermark '+l+'pos"></td><td class="'+l+'name"><input class="'+l+'edit_ratio_name" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_met" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_cry" type="text" /></td><td class="'+l+'ratio"><input class="'+l+'edit_ratio_deu" type="text" /></td><td class="'+l+'action"><a {this.VOID_HREF} class="'+l+'icon_add"></a></td><td class="'+l+'legal"></td><td class="'+l+'label">-</td></tr>';w.init();var K=(function(){var R=f('meta[name="ogame-universe"]').attr("content");
/*! [default_ratios] */
;return/^\w+\.ogame\.org$/.test(R)?[3,2,1,2,1,1,3,2,1]:[3,2,1,2,1.5,1,3,2,1];
/*! [/default_ratios] */
})();var H=function(){return(new Date()).getTime()};var s=function(){};var E=function(R){R.preventDefault()};var P={getDefaultData:function(){
/*! [config=default] */
;return{version:k.VERSION.slice(0),defAction:"sell",ratioList:[{id:"MAX",ratio:[K[0],K[1],K[2]]},{id:"MIN",ratio:[K[3],K[4],K[5]]},{id:"REG",ratio:[K[6],K[7],K[8]]}],defRatio:"REG",defOutput:"m",millionAbb:"M",millionKey:"m",thousandAbb:"K",thousandKey:"k",abb:false,overUnabb:false,selCurPla:false,messageTpl:"[b]{?b}{I18N.BUY}{/b}{?s}{I18N.SELL}{/s}:[/b] {?m}[b][color={COLOR.MET}]{m}[/color][/b] ({I18N.RES_MET}){?cd} + {/cd}{/m}{?c}[b][color={COLOR.CRY}]{c}[/color][/b] ({I18N.RES_CRY}){?d} + {/d}{/c}{?d}[b][color={COLOR.DEU}]{d}[/color][/b] ({I18N.RES_DEU}){/d}\n[b]{I18N.IN_EXCH}:[/b] {?M}[b][color={COLOR.MET}]{M}[/color][/b] ({I18N.RES_MET}){?CD} + {/CD}{/M}{?C}[b][color={COLOR.CRY}]{C}[/color][/b] ({I18N.RES_CRY}){?D} + {/D}{/C}{?D}[b][color={COLOR.DEU}]{D}[/color][/b] ({I18N.RES_DEU}){/D}\n\n[b]* {I18N.SEND}:[/b] {sr} ({I18N.RES}) = [b][color={COLOR.LC}]{sl}[/color][/b] ({I18N.LC_SHIP}) {I18N.OR} [b][color={COLOR.SC}]{ss}[/color][/b] ({I18N.SC_SHIP})\n[b]* {I18N.RECEIVE}:[/b] {rr} ({I18N.RES}) = [b][color={COLOR.LC}]{rl}[/color][/b] ({I18N.LC_SHIP}) {I18N.OR} [b][color={COLOR.SC}]{rs}[/color][/b] ({I18N.SC_SHIP})\n\n[b]* {I18N.RATIO}:[/b] {rm}:{rc}:{rd}{?w}\n[b]* {I18N.WHERE}:[/b] {wg}:{ws}:{wp} ({wt}){/w}\n\n[b][url={SCRIPT.HOME_URL}]{SCRIPT.NAME}[/url][/b]"};
/*! [/config] */
},abbRE:/^\S+$/,keyRE:/^\S$/,_error:function(R){throw"DataError: "+R},_errorUndefined:function(R){this._error(R+" is undefined")},_errorExpected:function(R,S,T,U){var W,V=T+"";if(/^[\<\>]\d+$/.test(V)){if(V.charAt(0)==">"){W="greater"}else{W="less"}W+=" than "+V.slice(1)}else{W='"'+V.split(":").join(" or ")+'"'}this._error(R+": "+S+" "+W+' expected but "'+U+'" found')},_errorType:function(R,S,T){if(T=="undefined"){this._errorUndefined(R)}else{this._errorExpected(R,"type",S,T)}},_errorValue:function(R,S,T){this._errorExpected(R,"value",S,T)},_errorValueRE:function(R,S,T){this._error(R+': value "'+T+'" doesn\'t match the expected RegExp "'+S+'"')},_errorLength:function(R,S,T){this._errorExpected(R,"length",S,T)},parseData:function(S){var T,R,ab,U=this,V=(typeof(S)=="string")?JSON.parse(S):S,ac="boolean",aa="string",W="number";if((ab=typeof(V.defAction))!=aa){U._errorType("defAction",aa,ab)}if(typeof(V.ratioList)=="undefined"){U._errorUndefined("ratioList")}if(!(/^sell|buy$/.test(V.defAction))){U._errorValue("defAction","sell:buy",V.defAction)}ab=typeof(V.defRatio);if(!(/^number|string$/.test(ab))){U._errorType("defRatio",aa+":"+W,ab)}var X=true,Y=true,Z=true;for(T=0;T<V.ratioList.length;T++){R=V.ratioList[T];if((ab=R.ratio.length)!=3){U._errorLength("ratioList["+T+"]",3,ab)}if((R.ratio[0]+=0)<=0){U._errorValue("ratioList["+T+"].ratio[0]",">0",R.ratio[0])}if((R.ratio[1]+=0)<=0){U._errorValue("ratioList["+T+"].ratio[1]",">0",R.ratio[1])}if((R.ratio[2]+=0)<=0){U._errorValue("ratioList["+T+"].ratio[2]",">0",R.ratio[2])}if(R.id==V.defRatio){Z=false}if(/^MAX|MIN|REG$/.test(R.id+"")){if(R.id=="MAX"){X=false}else{if(R.id=="MIN"){Y=false}}}else{if((ab=typeof(R.id))!=W){U._errorType("ratioList["+T+"].id",W,ab)}if((ab=typeof(R.name))!=aa){U._errorType("ratioList["+T+"].name",aa,ab)}}}if(X){U._error('ratioList: maximum ratio (id="MAX") not found')}if(Y){U._error('ratioList: minimum ratio (id="MIN") not found')}if(Z){U._error('ratioList: default ratio (id="'+V.defRatio+'" == defRatio) not found')}R=V.ratioList.slice(0).sort();for(T=1;T<R.length;T++){if(R[T-1].id==R[T].id){U._error('ratioList: duplicate id "'+R[T].id+'" found')}}if(!(/^m|c|d|mc|md|cd$/.test(V.defOutput))){U._errorValue("defOutput","m:c:d:mc:md:cd",V.defOutput)}if((ab=typeof(V.millionAbb))!=aa){U._errorType("millionAbb",aa,ab)}if((ab=V.millionAbb.length)<1){U._errorLength("millionAbb",">0",ab)}if(!U.abbRE.test(ab=V.millionAbb)){U._errorValueRE("millionAbb",U.abbRE,ab)}if((ab=typeof(V.millionKey))!=aa){U._errorType("millionKey",aa,ab)}if((ab=V.millionKey.length)!=1){U._errorLength("millionKey",1,ab)}if(!U.keyRE.test(ab=V.millionKey)){U._errorValueRE("millionKey",U.keyRE,ab)}if((ab=typeof(V.thousandAbb))!=aa){U._errorType("thousandAbb",aa,ab)}if((ab=V.thousandAbb.length)<1){U._errorLength("thousandAbb",">0",ab)}if(!U.abbRE.test(ab=V.thousandAbb)){U._errorValueRE("thousandAbb",U.abbRE,ab)}if((ab=typeof(V.thousandKey))!=aa){U._errorType("thousandKey",aa,ab)}if((ab=V.thousandKey.length)!=1){U._errorLength("thousandKey",1,ab)}if(!U.keyRE.test(ab=V.thousandKey)){U._errorValueRE("thousandKey",U.keyRE,ab)}if((ab=typeof(V.abb))!=ac){U._errorType("abb",ac,ab)}if((ab=typeof(V.overUnabb))!=ac){U._errorType("overUnabb",ac,ab)}if((ab=typeof(V.selCurPla))!=ac){U._errorType("selCurPla",ac,ab)}if((ab=typeof(V.messageTpl))!=aa){U._errorType("messageTpl",aa,ab)}return V},getRatio:function(S,V){var U=(arguments.length>1)?V.ratioList[S]:this.data.ratioList[S],W=U.id+"",R,T=U.ratio.slice(0);if("name" in U){R=U.name+""}else{R=D[W]}return{id:W,ratio:T,name:R,val:W+":"+T[0]+":"+T[1]+":"+T[2],met:T[0],cry:T[1],deu:T[2]}},getRatioById:function(V,T){var R,U=(arguments.length>1)?T:this.data,S=U.ratioList;for(R in S){if(S[R].id==V){return this.getRatio(R,U)}}return null},updateVersion:function(W){var R=(typeof(W.version)=="undefined")?0:W.version,S,V=this.getDefaultData();if(o(R,[2,4])){W.messageTpl=V.messageTpl}if(o(R,[2,5,3])){var U=W.ratioList,T=false;for(S in U){if(U[S].id=="MAX"){break}}if(S<U.length||U[S].ratio.join(":")=="5:3:1"){U[S].ratio=this.getRatioById("MAX",V).ratio}}W.version=V.version;for(S in V){if(typeof(W[S])=="undefined"){W[S]=V[S]}}return W},save:function(R){if(arguments.length>0){this.data=R}this.data=this.updateVersion(this.data);h.set("config",this.data);return this},load:function(){var R=h.get("config");if(R==null){this.data=this.getDefaultData()}else{this.save(R)}return this},remove:function(){h.remove("config");this.data=this.getDefaultData()}};var F={formatI:function(V,T){var U,R=(arguments.length>1&&T);if(R&&V==""){return""}if(typeof(V)=="string"){U=("0"+V+"").replace(new RegExp(P.data.thousandKey+"$","i"),"000").replace(new RegExp(P.data.millionKey+"$","i"),"000000").replace(/\D/g,"").replace(/^0+(\d)/,"$1")}else{U=V.toFixed()+""}var S=/(\d+)(\d{3})/;while(S.test(U)){U=U.replace(S,"$1"+D.THO_SEP+"$2")}if(!R&&P.data.abb){return U.replace(/\D000\D000$/,P.data.millionAbb).replace(/\D([1-9])00\D000$/,D.DEC_SEP+"$1"+P.data.millionAbb).replace(/\D000$/,P.data.thousandAbb)}return U},formatF:function(Y,W){var X,R,V,T,S=(arguments.length>1&&W);if(S&&Y==""){return""}if(typeof(Y)=="string"){X=("0"+Y+"").replace(/[\.\,]$/,D.DEC_SEP).replace(new RegExp("[^0-9\\"+D.DEC_SEP+"]","g"),"").replace(/^0+(\d)/,"$1")}else{X=(Y+"").replace(".",D.DEC_SEP)}R=X.split(D.DEC_SEP);V=R[0];T=R.length>1?D.DEC_SEP+R[1]:"";if(X[X.length-1]==D.DEC_SEP&&S){T=D.DEC_SEP}var U=/(\d+)(\d{3})/;while(U.test(V)){V=V.replace(U,"$1"+D.THO_SEP+"$2")}return V+T},parseI:function(S){var R=F.parseF(S);if(new RegExp(P.data.thousandAbb+"$","i").test(S)){R=R*1000}else{if(new RegExp(P.data.millionAbb+"$","i").test(S)){R=R*1000000}}return Math.round(R)},parseF:function(R){return parseFloat(R.replaceAll(D.THO_SEP,"").replace(D.DEC_SEP,".").replace(/[^\d\.]/g,""))}};var Q=function(){if(arguments.length<1){this.setLimits()}else{if(arguments.length<2){this.setLimits(arguments[0])}else{this.setLimits(arguments[0],arguments[1])}}};Q.prototype={limits:[],isLegal:function(){var T;if(arguments.length==1){T=arguments[0]}else{T=[arguments[0],arguments[1],arguments[2]]}var S=T[0]/T[1],R=0;if(S<this.limits[R++]||S>this.limits[R++]){return false}S=T[0]/T[2];if(S<this.limits[R++]||S>this.limits[R++]){return false}S=T[1]/T[2];if(S<this.limits[R++]||S>this.limits[R++]){return false}return true},setLimits:function(U,T){if(arguments.length<2){var Y,X,V,W=(arguments.length>0)?U.ratioList:P.data.ratioList;for(V in W){if(W[V].id=="MAX"){Y=W[V].ratio}else{if(W[V].id=="MIN"){X=W[V].ratio}}}return this.setLimits(Y,X)}this.limits=[];var S=U[0]/U[1],R=T[0]/T[1];this.limits.push(Math.min(S,R));this.limits.push(Math.max(S,R));S=U[0]/U[2];R=T[0]/T[2];this.limits.push(Math.min(S,R));this.limits.push(Math.max(S,R));S=U[1]/U[2];R=T[1]/T[2];this.limits.push(Math.min(S,R));this.limits.push(Math.max(S,R));return this}};var J,G;var u=function(V,W,U,Y,Z,X,S,T,R){return{met:Math.round(((V+(W/Z)*Y+(U/X)*Y)/100)*S),cry:Math.round((((V/Y)*Z+W+(U/X)*Z)/100)*T),deu:Math.round((((V/Y)*X+(W/Z)*X+U)/100)*R)}};var N={parseIf:function(X,Y,R){var Z="{?"+Y+"}",U="{/"+Y+"}";if(R){return X.split(Z).join("").split(U).join("")}var W,V,S,T=X;while((W=T.indexOf(Z))>=0&&(V=T.indexOf(U))>=0&&W<V){T=T.split(Z);for(W=1;W<T.length;W++){S=T[W].split(U);if(S.length>1){S.shift();T[W]=U+S.shift()+S.join(U)}}T=T.join(Z).split(Z+U).join("")}return T},parseIfs:function(V,Z){var U=V+"",T=V+"",ab=/\{\?(\!?\w)+\}/,X,aa,Y,S,R;while(ab.test(U)){X=(ab.exec(U)+"").replace(/\}.*$/,"").replace(/^.*\{/,"");U=U.split("{"+X+"}").join("");try{X=X.replace(/[^\w\!]/g,"");if((R=X[Y=0])=="!"){aa=!Z[++Y]}else{aa=Z[R]}S=X.length-1;aa=Z[X[Y]];while(Y<S){if((R=X[++Y])=="!"){aa=(aa||!Z[++Y])}else{aa=(aa||Z[R])}}T=this.parseIf(T,X,aa)}catch(W){alert(W)}}return T},make:function(U,Z,R,T,S,Y,W){var X,aa=/[1-9]/,V=this.parseIfs(P.data.messageTpl,{b:(U=="buy"),s:(U=="sell"),m:aa.test(Z.met),c:aa.test(Z.cry),d:aa.test(Z.deu),M:aa.test(R.met),C:aa.test(R.cry),D:aa.test(R.deu),w:W.use});V=V.replaceMap({"{m}":Z.met,"{c}":Z.cry,"{d}":Z.deu,"{M}":R.met,"{C}":R.cry,"{D}":R.deu,"{sr}":T.res,"{sl}":T.lc,"{ss}":T.sc,"{rr}":S.res,"{rl}":S.lc,"{rs}":S.sc,"{rm}":Y.met,"{rc}":Y.cry,"{rd}":Y.deu,"{wg}":W.galaxy,"{ws}":W.system,"{wp}":W.planet,"{wt}":W.use?"{I18N."+(W.type+"").toUpperCase()+"}":0});for(X in D){V=V.replaceAll("{I18N."+X+"}",D[X])}for(X in k){V=V.replaceAll("{SCRIPT."+X+"}",k[X])}for(X in C){V=V.replaceAll("{COLOR."+X+"}",C[X])}return V}};var L=function(S,R){this.jqo=S;if(arguments.length>1){this.val(R)}};L.prototype={val:function(R){if(arguments.length<1){return this.jqo.val()}this.jqo.val(R);return this},disable:function(){this.jqo.attr("disabled","disabled").prop("disabled",true);return this},enable:function(){this.jqo.prop("disabled",false).removeAttr("disabled");return this},isDisabled:function(){return this.jqo.prop("disabled")}};var I=function(S,R){this.jqo=S;if(arguments.length>1){this.val(R)}};I.prototype=f.extend({},L.prototype,{val:function(R){if(arguments.length<1){return this.isChecked()}if(R){this.check()}else{this.uncheck()}return this},check:function(){this.jqo.attr("checked","checked").prop("checked",true);return this},uncheck:function(){this.jqo.prop("checked",false).removeAttr("checked");return this},isChecked:function(){return this.jqo.prop("checked")}});var v=function(W,V,T,U){var X=this,R=(X.jqo=W),S;X.value=V;X.regExp=T;X.clearOnFocus=U;X.allowEmpty=true;X.onChange=s;if(arguments.length>4){if(arguments.length>5){X.allowEmpty=arguments[4];X.onChange=arguments[5]}else{if(typeof(arguments[4])=="function"){X.onChange=arguments[4]}else{X.allowEmpty=(arguments[4]&&true)}}}S=function(){var aa=R.val(),Y=aa.length;if(X.allowEmpty||Y>0){if(X.regExp.test(aa)){X.value=aa.trim()}else{var ab=R.caret(),ac=Y-ab.start,Z=Y-ab.end;Y=X.value.length;ac=Math.max(Math.min(Y-ac,Y),0);Z=Math.max(Math.min(Y-Z,Y),0);R.val(X.value);R.caret(ac,Z)}X.onChange()}};R.val(V).keyup(S).change(S).blur(function(){R.val(X.value)}).focus(function(){if(X.clearOnFocus){if(X.allowEmpty){X.val("")}else{R.val("")}}})};v.prototype=f.extend({},L.prototype,{val:function(R){if(arguments.length<1){return this.value}this.jqo.val(this.value=R);return this}});var B=function(X,W,V,U){var Y=this,R=(this.jqo=X),T,S=V;this.allow0=true;this.focused=false;this.onChange=s;this.clearOnFocus=U;S=V.substring(0,1).toUpperCase();if(this.typePercent=(S=="P")){S="F"}this.formatFunc=F["format"+S];this.parseFunc=F["parse"+S];if(arguments.length>4){if(arguments.length>5){this.allow0=arguments[4];this.onChange=arguments[5]}else{if(typeof(arguments[4])=="function"){this.onChange=arguments[4]}else{this.allow0=(arguments[4]&&true)}}}this.set(W);T=function(){var ad=Y.jqo,ab=ad.val(),ac=ad.caret(),Z=ab.length,ae=Z-ac.start,aa=Z-ac.end;ab=Y.formatFunc(ad.val(),true);Z=ab.length;ae=Math.max(Math.min(Z-ae,Z),0);aa=Math.max(Math.min(Z-aa,Z),0);num=(ab=="")?0:Y.parseFunc(ab);if(Y.allow0||num>0){Y.set(ab,true).onChange(Y)}ad.caret(ae,aa)};R.keyup(function(Z){if(!(/^9|16$/.test(Z.which+""))){T()}}).change(T).blur(function(){Y.set(Y.num);Y.focused=false}).focus(function(){Y.focused=true;var ab=f(this);if(Y.clearOnFocus||Y.num==0){ab.val("")}else{var aa=ab.caret(),Z=ab.val().length;ab.val(Y.formatFunc(Y.num,true));if(aa.end==Z){if(aa.start==Z){aa.start=(--aa.end)}else{aa.end--}}Z=ab.val().length;ab.caret(Math.min(Math.max(0,aa.start),Z),Math.min(Math.max(0,aa.end),Z))}}).mouseenter(function(){if(P.data.overUnabb&&!(Y.typePercent||Y.focused||Y.clearOnFocus)){var Z=Y.jqo;Z.val(Y.formatFunc(Y.num,true));if(Z.val()==""){Z.val(0)}}}).mouseleave(function(){if(P.data.overUnabb&&!(Y.typePercent||Y.focused||Y.clearOnFocus)){Y.jqo.val(Y.txt)}})};B.prototype=f.extend({},L.prototype,{set:function(U,T){var R,S=(arguments.length>1&&T);if(typeof(U)=="string"){R=(U+"").replace(/\%$/,"");this.num=(R=="")?0:this.parseFunc(R);this.txt=this.formatFunc(this.num)+(this.typePercent?"%":"")}else{this.num=U;this.txt=(R=this.formatFunc(U))+(this.typePercent?"%":"")}this.jqo.val(S?R:this.txt);return this}});var t=function(S,R){var T=this;T.jqo=S;T.val(R);T.jqo.mouseenter(function(){T._mouseenter()}).mouseleave(function(){T._mouseleave()})};t.prototype={val:function(R){if(arguments.length>0){this.jqo.text(F.formatI(R));this.num=R;return this}return this.jqo.text()},_mouseenter:function(){if(P.data.overUnabb&&this.num>0){this.jqo.text(F.formatI(this.num,true))}},_mouseleave:function(){if(P.data.overUnabb){this.jqo.text(F.formatI(this.num))}}};var A=function(V,T){var W=this,R=(this.jqo=V);this.onChange=T;R.change(function(){W.set().onChange()});f('<option value="">-</option>').appendTo(R);var U=f('meta[name="ogame-planet-coordinates"]').attr("content").replace(/[^0-9\:]/g,"");var S=f('meta[name="ogame-planet-type"]').attr("content").toLowerCase().trim();f.each(f("#planetList").children("div").get(),function(X,Y){var Z=f(Y),aa=Z.find(".planet-koords");if(aa.get().length==0){return}aa=aa.text().replace(/[^0-9\:]/g,"");option=f('<option value="planet:'+aa+'">['+aa+"] "+Z.find(".planet-name").text().trim()+"</option>").appendTo(R);if(aa==U&&S=="planet"){W._setCurrent(option)}if(Z.find(".moonlink").get().length>0){option=f('<option value="moon:'+aa+'">['+aa+"] ("+D.MOON+")</option>").appendTo(R).addClass(l+"moon");if(aa==U&&S=="moon"){W._setCurrent(option)}}})};A.prototype={use:false,type:0,galaxy:0,system:0,planet:0,set:function(R){var S=((arguments.length>0)?R:this.jqo.val()).split(":");if(S.length<4){this.use=false}else{this.use=true;this.type=S.shift();this.galaxy=S.shift();this.system=S.shift();this.planet=S.shift()}return this},_setCurrent:function(R){R.addClass(l+"highlight").html(R.html()+" &laquo; "+D.CUR_PLA);if(P.data.selCurPla){R.attr("selected","selected")}this.current=R;this.set()},clickCurrent:function(){this.jqo.val(this.current.val()).change()}};var M=function(U,X,V){var S,R,W=this,T;if(arguments.length<4){this.isNew=false;this.name=("name" in V)?V.name:(V.id=="MAX")?D.MAX:(V.id=="MIN")?D.MIN:D.REG;this.id=V.id;T=V.ratio}else{this.isNew=true;this.name="*"+D.NEW;T=P.getRatioById(V.defRatio,V).ratio}this.list=U;if(this.isLimit=/^MIN|MAX$/.test(this.id)){this.jqo=f(w.RATIO_LIST_LIMIT).appendTo(U.jqo);this.jqo.find("."+l+"name_noedit").text(this.name)}else{this.jqo=f(this.isNew?w.RATIO_LIST_NEW:w.RATIO_LIST_ITEM).appendTo(U.jqo);this.nameInput=this.jqo.find("."+l+"edit_ratio_name");this.nameInput.change(function(){W.name=W.nameInput.val().trim()}).keyup(function(){W.nameInput.change()}).val(this.name)}this.posLabel=this.jqo.find("."+l+"pos");this.setPos(X);R=["met","cry","deu"];for(S in R){this[R[S]+"Input"]=new B(this.jqo.find("."+l+"edit_ratio_"+R[S]),T[S],"f",true,false,function(){W.list.onChange()})}this.addButton=this.jqo.find("."+l+"icon_add").click(function(){var Z=W.list,Y=new M(Z,W.pos,W.getInfo());Y.disableDown().jqo.after(W.jqo);Z.list[W.pos]=Y;Z.list[W.pos-1].enableDown();W.nameInput.val(W.name="*"+D.NEW);W.setPos(++W.pos)});this.upButton=this.jqo.find("."+l+"icon_up").click(function(){W.move(true)});this.upDisabled=false;this.downButton=this.jqo.find("."+l+"icon_down").click(function(){W.move(false)});this.downDisabled=false;this.trashButton=this.jqo.find("."+l+"icon_trash");if(this.isLimit){this.trashButton.addClass("disabled")}else{this.trashButton.click(function(){W.remove()})}this.radio=this.jqo.find('input[name="'+l+'def_ratio"]').click(function(){W.list.defRatio=W.id});if(U.defRatio==this.id){this.radio.click()}this.legal=this.jqo.find("."+l+"legal")};M.prototype={getInfo:function(){var S=this,R={id:S.isNew?H():S.id,ratio:[S.metInput.num,S.cryInput.num,S.deuInput.num]};if((!S.isLimit)&&(S.isNew||S.id!="REG"||S.name!=D.REG)){R.name=S.name}return R},move:function(S){var T,R;if(S){if(this.upDisabled){return this}T=this.list.list[this.pos-1];this.jqo.after(T.jqo)}else{if(this.downDisabled){return this}T=this.list.list[this.pos+1];T.jqo.after(this.jqo)}R=this.pos;this.setPos(T.pos);T.setPos(R);R=T.upDisabled;if(this.upDisabled){T.disableUp()}else{T.enableUp()}if(R){this.disableUp()}else{this.enableUp()}R=T.downDisabled;if(this.downDisabled){T.disableDown()}else{T.enableDown()}if(R){this.disableDown()}else{this.enableDown()}this.list.sortList()},remove:function(){var T,R=[],U=this.list.list,S=this.list.newItem;this.jqo.remove();U.splice(this.pos,1);for(T=0;T<U.length;T++){R[T]=(U[T].setPos(T))}this.list.list=R;if(this.list.defRatio==this.id){R[0].radio.click()}if(this.downDisabled){R[R.length-1].disableDown()}if(this.upDisabled){R[0].disableUp()}S.setPos(S.pos-1)},enableUp:function(){this.upDisabled=false;this.upButton.removeClass("disabled");return this},enableDown:function(){this.downDisabled=false;this.downButton.removeClass("disabled");return this},disableUp:function(){this.upDisabled=true;this.upButton.addClass("disabled");return this},disableDown:function(){this.downDisabled=true;this.downButton.addClass("disabled");return this},setLegal:function(R){if(R){this.legal.text(D.YES).addClass("undermark").removeClass("overmark")}else{this.legal.text(D.NO).addClass("overmark").removeClass("undermark")}return this},setPos:function(R){if(R%2==0){this.jqo.addClass("alt")}else{this.jqo.removeClass("alt")}this.pos=R;this.posLabel.html(this.isNew?"+":R+1);return this}};var z={list:[],limits:[],clear:function(){for(var R in this.list){this.list[R].jqo.remove()}this.list=(this.limits=[]);try{this.newItem.jqo.remove()}catch(S){}},sortList:function(){this.list.sort(function(S,R){return S.pos-R.pos})},build:function(S){var U,V,T=(arguments.length>0)?S:P.data;this.clear();this.defRatio=T.defRatio;for(U=0;U<T.ratioList.length;U++){V=new M(this,U,T.ratioList[U]);this.list[U]=V;if(V.isLimit){this.limits[this.limits.length]=V}}var R=this.list.length;this.newItem=new M(this,R,T,true);this.list[0].disableUp();this.list[R-1].disableDown();this.onChange()},updateData:function(R){var T=(arguments.length>0)?R:P.data;T.ratioList=[];for(var S in this.list){T.ratioList[S]=this.list[S].getInfo()}T.defRatio=this.defRatio},onChangeItem:function(R){if(!R.isLimit){R.setLegal(G.isLegal(R.getInfo().ratio))}},onChange:function(){G.setLimits(this.limits[0].getInfo().ratio,this.limits[1].getInfo().ratio);for(var R=0;R<this.list.length;R++){this.onChangeItem(this.list[R])}this.onChangeItem(this.newItem)},init:function(R){this.jqo=R}};var x=function(S,W,T,R,V){var U=this;this.list=S;this.iface=V;this.pos=W;this.title=T.click(function(){U._click()});this.box=R;if(R.hasClass(l+"hidden")){this.setOpen(false)}else{this.setOpen(true)}};x.prototype={updateOpenCss:function(){this.openCss={height:this.box.height()+"px","padding-top":this.box.css("padding-top"),"padding-bottom":this.box.css("padding-bottom"),"margin-top":this.box.css("margin-top"),"margin-bottom":this.box.css("margin-bottom")};return this},closeCss:{height:0,"padding-top":0,"padding-bottom":0,"margin-top":0,"margin-bottom":0},afterOpenCss:{height:"auto"},duration:250,setOpen:function(R){if(this.isOpen=R){this.list.itemOpen=this}return this},open:function(){this.updateOpenCss().box.removeClass(l+"hidden");return this.setOpen(true)},close:function(){this.updateOpenCss().box.addClass(l+"hidden");return this.setOpen(false)},animateOpen:function(){var R=this.afterOpenCss;this.updateOpenCss().box.css(this.closeCss).removeClass(l+"hidden").animate(this.openCss,this.duration,function(){f(this).css(R)});return this.setOpen(true)},animateClose:function(){var R=this;this.updateOpenCss().box.css(this.openCss).animate(this.closeCss,this.duration,function(){f(this).addClass(l+"hidden").css(R.openCss).css(R.afterOpenCss)});return this.setOpen(false)},_click:function(){if(!this.isOpen){this.iface.clearExport();this.list.itemOpen.animateClose();this.animateOpen()}}};var O={init:function(T,U){this.jqo=T;var S,R=[];T.find("."+l+"config_title").each(function(V,W){R[V]={title:f(W)}});T.find("."+l+"config_box").each(function(V,W){R[V].box=f(W)});this.list=[];for(S=0;S<R.length;S++){this.list[S]=new x(this,S,R[S].title,R[S].box,U)}}};var y=({addCss:function(T){var S=q.createElement("style");S.setAttribute("type","text/css");if(S.styleSheet){S.styleSheet.cssText=T}else{S.appendChild(q.createTextNode(T))}var R=q.getElementsByTagName("head")[0];R.appendChild(S);return this},findIDP:function(R){return this.window.find("#"+l+R)},menuButton:null,menuButtonAction:function(){this.menuButtonAction=function(){};this.makeWindow()},makeMenuButton:function(){var R=this;this.menuButton=f(w.MENUBUTTON).appendTo(f("#menuTableTools")).find("#"+l+"menubutton").click(function(){R.menuButtonAction()});return R},window:null,ogameHide:null,isHidden:true,show:function(){this.isHidden=false;this.ogameHide.hide();this.window.show();this.menuButton.addClass("selected");return this},hide:function(){this.isHidden=true;this.window.hide();this.ogameHide.show();this.menuButton.removeClass("selected");return this},toggle:function(){if(this.isHidden){return this.show()}return this.hide()},makePlanetSelect:function(){var R=this;R.planet=new A(R.findIDP("planet"),function(){R.onChange()});return R},makeActionSelect:function(){var R=this;R.actionJqo=R.findIDP("action").change(function(){R.action=f(this).val();R.onChange()}).val(R.action=P.data.defAction);return R},makeResourceInput:function(R,S){var T=this;T["input"+R.capitalize()]=new B(T.findIDP("input_"+R),S,"i",false,true,function(){T.checkOutputSelect().onChange()});return T},makeRatioSelect:function(){var R=this;this.ratioSelectJqo=R.findIDP("ratio").change(function(){var S=f(this).val().split(":");if(S.length>3){f(this).val("");R.ratioMet.set(parseFloat(S[1]));R.ratioCry.set(parseFloat(S[2]));R.ratioDeu.set(parseFloat(S[3]));R.checkRatio().onChange()}});return R.updateRatioSelect()},updateRatioSelect:function(){var S,R=this.ratioSelectJqo.html("").append(f('<option value="">-</option>'));for(S in P.data.ratioList){ratio=P.getRatio(S);R.append(f('<option value="'+ratio.val+'">'+F.formatF(ratio.met)+":"+F.formatF(ratio.cry)+":"+F.formatF(ratio.deu)+" ("+ratio.name+")</option>"))}this.ogameDropDown(R);return this},makeRatioInput:function(R,S){var T=this;T["ratio"+R.capitalize()]=new B(T.findIDP("ratio_"+R),S,"f",true,false,function(){T.checkRatio().onChange()});return T},checkRatio:function(){var R=this;if(J.isLegal(R.ratioMet.num,R.ratioCry.num,R.ratioDeu.num)){R.ratioIllegal.hide()}else{R.ratioIllegal.show()}return R},makePercentInput:function(R){var T=this,S="percent"+R.capitalize();T[S]=new B(T.findIDP("percent_"+R),0,"p",false,true,function(W){if(W.num>100){W.set(100,true)}var U="percentMet",V;if(/Met|Cry/.test(S)&&(!T.percentDeu.isDisabled())){U="percentDeu"}else{if(/Met|Deu/.test(S)&&(!T.percentCry.isDisabled())){U="percentCry"}}V=parseFloat((100-W.num).toFixed((W.num+"").split(".").pop().length));T[U].set(V);T.onChange()});return T},checkOutputSelect:function(){var W=this,Z=W.outputJqo,U=Z.val(),Y=(W.inputMet.num>0),V=(W.inputCry.num>0),T=(W.inputDeu.num>0),X=/m/.test(U),S=/c/.test(U),R=/d/.test(U);if(!Y&&!V&&T&&!X&&!S&&R){Z.val("mc").change()}else{if(!Y&&V&&!T&&!X&&S&&!R){Z.val("md").change()}else{if(Y&&!V&&!T&&X&&!S&&!R){Z.val("cd").change()}else{if((!Y&&V&&T)||X&&((V&&S)||(T&&R))){Z.val("m").change()}else{if((Y&&!V&&T)||S&&((Y&&X)||(T&&R))){Z.val("c").change()}else{if((Y&&V&&!T)||R&&((Y&&X)||(V&&S))){Z.val("d").change()}}}}}}return W},changeOutputSelect:function(R){this.outputJqo.val(R);m=this.percentMet.disable().set(0),c=this.percentCry.disable().set(0),d=this.percentDeu.disable().set(0);if(R=="m"){m.set(100)}else{if(R=="c"){c.set(100)}else{if(R=="d"){d.set(100)}else{if(R=="mc"){m.enable().set(50);c.enable().set(50)}else{if(R=="md"){m.enable().set(50);d.enable().set(50)}else{c.enable().set(50);d.enable().set(50)}}}}}return this},makeOutputSelect:function(){var R=this;this.outputJqo=R.findIDP("output").change(function(){R.changeOutputSelect(f(this).val());R.onChange()});return R},toggleConfigCalc:function(){this.window.toggleClass("config").toggleClass("calc");return this},updateConfigData:function(R){var T=this,S=(arguments.length>0)?R:P.data;z.updateData(S);S.defAction=T.defAction.val();S.defOutput=T.defOutput.val();S.selCurPla=T.selCurPla.val();S.abb=T.abb.val();S.overUnabb=T.overUnabb.val();S.millionAbb=T.millionAbb.val();S.millionKey=T.millionKey.val();S.thousandAbb=T.thousandAbb.val();S.thousandKey=T.thousandKey.val();S.messageTpl=T.messageTpl.val();return T},updateConfigIface:function(R){var T=this,S=(arguments.length>0)?R:P.data;G.setLimits(S);z.build(S);T.defAction.val(S.defAction);T.defOutput.val(S.defOutput);T.selCurPla.val(S.selCurPla);T.abb.val(S.abb);T.overUnabb.val(S.overUnabb);T.millionAbb.val(S.millionAbb);T.millionKey.val(S.millionKey);T.thousandAbb.val(S.thousandAbb);T.thousandKey.val(S.thousandKey);T.messageTpl.val(S.messageTpl);T.ieInput.val("");return T},updateCalcIface:function(){J.setLimits();this.inputMet.set(this.inputMet.num);this.inputCry.set(this.inputCry.num);this.inputDeu.set(this.inputDeu.num);this.updateRatioSelect().checkRatio().onChange();return this},makeConfigButtons:function(){var R=this;R.findIDP("config_but").click(function(){R.toggleConfigCalc()});R.findIDP("config_accept").click(function(){R.updateConfigData();P.save();R.updateCalcIface();R.toggleConfigCalc()});R.findIDP("config_cancel").click(function(){R.updateConfigIface();R.toggleConfigCalc()});R.findIDP("config_default").click(function(){P.remove();R.updateCalcIface();R.updateConfigIface();R.toggleConfigCalc()});return R},makeImportExport:function(){var R=this;R.ieInput=R.findIDP("ie_conf").focus(function(){f(this).select()});R.findIDP("ie_import").click(function(){try{var S=P.parseData(R.ieInput.val());R.updateConfigIface(S)}catch(T){alert(T)}});R.findIDP("ie_export").click(function(){var S=f.extend({},P.data);R.updateConfigData(S);R.ieInput.val("").val(JSON.stringify(S)).select()});return R},makeAbbKey:function(){var R=this;R.abb=new I(R.findIDP("abb"));R.overUnabb=new I(R.findIDP("overUnabb"));R.millionAbb=new v(R.findIDP("millionAbb"),P.data.millionAbb,P.abbRE,true,false);R.thousandAbb=new v(R.findIDP("thousandAbb"),P.data.thousandAbb,P.abbRE,true,false);R.millionKey=new v(R.findIDP("millionKey"),P.data.millionKey,P.keyRE,true,false);R.thousandKey=new v(R.findIDP("thousandKey"),P.data.thousandKey,P.keyRE,true,false);return R},makeMessageTpl:function(){var R=this;R.messageTpl=R.findIDP("messageTpl");R.findIDP("messageTpl_restore").click(function(){R.messageTpl.val(P.getDefaultData().messageTpl)});return R},clearExport:function(){this.ieInput.val("");return this},ogameDropDown:function(Z){var W,V,T,U,X,R,S,ab,aa=null;try{if(Z.hasClass("dropdownInitialized")){Z.removeClass("dropdownInitialized");T=Z.next(".dropdown");R=T.attr("rel");aa=T.attr("style");T.remove();f("#"+R).remove()}T=f(".dropdown.dropdownList").get();Z.ogameDropDown()}catch(Y){return false}ab={select:Z};S=function(){var ad,ac;ad=ab.select.val();ac=ab.select.find('[value="'+ad+'"]').text();ab.dropdown.attr("data-value",ad).text(ac)};U=f(".dropdown.dropdownList").get();for(W=0;W<T.length;W++){T[W]=f(T[W])}for(W=0;W<U.length;W++){U[W]=f(U[W]);R=U[W].attr("id");X=true;for(V=0;V<T.length;V++){if(T[V].attr("id")==R){X=false;break}}if(X){ab.dropdown=f('.dropdown [rel="'+R+'"]');if(aa!=null){ab.dropdown.parent().attr("style",aa)}S();Z.change(S);break}}return true},ogameDropDowns:function(){var S,R=this.window.find("select").get();if(!this.ogameDropDown(f(R[0]))){return}for(S=1;S<R.length;S++){this.ogameDropDown(f(R[S]))}},makeWindow:function(){w.init();P.load();J=new Q();G=new Q();var S=this,R=P.getRatioById(P.data.defRatio);S.ogameHide=f("#inhalt").after(this.window=f(w.WINDOW).hide());S.addCss(w.CSS).show();S.ratioIllegal=S.findIDP("ratio_illegal").hide();S.outputMessage=S.findIDP("message").click(function(){f(this).select()});S.outputMet=new t(S.findIDP("output_met"),0);S.outputCry=new t(S.findIDP("output_cry"),0);S.outputDeu=new t(S.findIDP("output_deu"),0);S.sendRes=new t(S.findIDP("sendRes"),0);S.sendLC=new t(S.findIDP("sendLC"),0);S.sendSC=new t(S.findIDP("sendSC"),0);S.receiveRes=new t(S.findIDP("receiveRes"),0);S.receiveLC=new t(S.findIDP("receiveLC"),0);S.receiveSC=new t(S.findIDP("receiveSC"),0);S.findIDP("close").click(function(){S.hide()});S.makeActionSelect().makeResourceInput("met",0).makeResourceInput("cry",0).makeResourceInput("deu",0).makeRatioSelect().makeRatioInput("met",R.met).makeRatioInput("cry",R.cry).makeRatioInput("deu",R.deu).makeOutputSelect().makePercentInput("met").makePercentInput("cry").makePercentInput("deu").changeOutputSelect(P.data.defOutput).makePlanetSelect().checkRatio();S.findIDP("selCurPla_button").click(function(){S.planet.clickCurrent()});S.menuButtonAction=function(){S.toggle()};S.makeImportExport();O.init(S.findIDP("config"),S);z.init(S.findIDP("ratioList"),this);S.defAction=S.findIDP("defAction");S.defOutput=S.findIDP("defOutput");S.selCurPla=new I(S.findIDP("selCurPla"));S.makeAbbKey().makeMessageTpl().makeConfigButtons().updateConfigIface();S.ogameDropDowns();return S},onChange:function(){var S=this,R=u(S.inputMet.num,S.inputCry.num,S.inputDeu.num,S.ratioMet.num,S.ratioCry.num,S.ratioDeu.num,S.percentMet.num,S.percentCry.num,S.percentDeu.num);S.outputMet.val(R.met);S.outputCry.val(R.cry);S.outputDeu.val(R.deu);if(S.action=="buy"){S.sendRes.val(R.met+R.cry+R.deu);S.receiveRes.val(S.inputMet.num+S.inputCry.num+S.inputDeu.num)}else{S.receiveRes.val(R.met+R.cry+R.deu);S.sendRes.val(S.inputMet.num+S.inputCry.num+S.inputDeu.num)}S.sendLC.val(Math.ceil(S.sendRes.num/25000));S.sendSC.val(Math.ceil(S.sendRes.num/5000));S.receiveLC.val(Math.ceil(S.receiveRes.num/25000));S.receiveSC.val(Math.ceil(S.receiveRes.num/5000));S.outputMessage.text(N.make(S.action,{met:S.inputMet.txt,cry:S.inputCry.txt,deu:S.inputDeu.txt},{met:S.outputMet.val(),cry:S.outputCry.val(),deu:S.outputDeu.val()},{res:S.sendRes.val(),lc:S.sendLC.val(),sc:S.sendSC.val()},{res:S.receiveRes.val(),lc:S.receiveLC.val(),sc:S.receiveSC.val()},{met:S.ratioMet.txt,cry:S.ratioCry.txt,deu:S.ratioDeu.txt},S.planet));return S},init:function(){if(/Chrome/i.test(i.navigator.userAgent)){this.ogameDropDowns=(this.ogameDropDown=s)}return this.makeMenuButton()}}).init()};var p=function(){try{f=i.jQuery;if(typeof(f)=="undefined"){throw 0}if(typeof(f.fn.ogameDropDown)=="undefined"){throw 0}a()}catch(s){setTimeout(p,50)}};
/*! [onDOMContentLoaded] by Dean Edwards & Matthias Miller & John Resig */
;var n=false,r=function(){if(n){return}n=true;if(b){clearInterval(b)}p()};if(q.addEventListener){q.addEventListener("DOMContentLoaded",r,false)}if(/WebKit/i.test(i.navigator.userAgent)){var b=setInterval(function(){if(/loaded|complete/.test(q.readyState)){r()}},10)}i.onload=r})();